layui.define(["jquery"],function(e){(function(e){var t,r=e(),i=null;e.fn.sortable=function(n){var a=String(n);return n=e.extend({connectWith:!1,placeholderStyle:"",placeholder:"sortable-placeholder"},n),this.each(function(){if(/^enable|disable|destroy$/.test(a)){var o=e(this).children(e(this).data("items")).attr("draggable","enable"==a);return void("destroy"==a&&o.add(this).removeData("connectWith items").off("dragstart.h5s dragend.h5s selectstart.h5s dragover.h5s dragenter.h5s drop.h5s"))}var s,d,o=e(this).children(n.items),h=e("<"+(/^ul|ol$/i.test(this.tagName)?"li":"div")+' class="'+n.placeholder+'" style="'+n.placeholderStyle+'">');o.find(n.handle).mousedown(function(){s=!0}).mouseup(function(){s=!1}),e(this).data("items",n.items),r=r.add(h),n.connectWith&&e(n.connectWith).add(this).data("connectWith",n.connectWith),o.attr("draggable","true").on("dragstart.h5s",function(r){if(n.handle&&!s)return!1;if(o.data("disabled"))return!1;s=!1;var a=r.originalEvent.dataTransfer;a.effectAllowed="move",a.setData("Text","dummy"),d=(t=e(this)).addClass("sortable-dragging").index(),i=t.parent().attr("id")}).on("dragend.h5s",function(){t&&(t.removeClass("sortable-dragging").show(),r.detach(),d==t.index()&&i==t.parent().attr("id")||t.parent().trigger("sortupdate",{item:t}),t=null)}).not("a[href], img").on("selectstart.h5s",function(){return this.dragDrop&&this.dragDrop(),!1}).end().add([this,h]).on("dragover.h5s dragenter.h5s drop.h5s",function(i){if(!o.is(t)&&n.connectWith!==e(t).parent().data("connectWith"))return!0;if("drop"==i.type)return i.stopPropagation(),r.filter(":visible").after(t),t.trigger("dragend.h5s"),!1;i.preventDefault(),i.originalEvent.dataTransfer.dropEffect="move";var a=e(i.currentTarget),s=a.parent();if(o.is(this)){if(!t.is(":visible")&&n.beforeDrop&&e.isFunction(n.beforeDrop))if(a.is(n.connectWith)){if(!n.beforeDrop(e(t),a))return!1}else if(s.is(n.connectWith)&&!n.beforeDrop(e(t),s))return!1;n.forcePlaceholderSize&&h.height(t.outerHeight()),t.hide(),e(this)[h.index()<e(this).index()?"after":"before"](h),r.not(h).detach()}else if(!r.is(this)&&!e(this).children(n.items).length){if(n.beforeDrop&&e.isFunction(n.beforeDrop))if(a.is(n.connectWith)){if(!n.beforeDrop(e(t),a))return!1}else if(s.is(n.connectWith)&&!n.beforeDrop(e(t),s))return!1;n.forcePlaceholderSize&&h.height(t.outerHeight()),r.detach(),e(this).append(h)}return!1})})}})(layui.$),e("sortable",{})});