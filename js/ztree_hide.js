layui.define(["jquery","ztree"],function(e){var i=layui.$,d={view:{clearOldFirstNode:function(e,i){for(var d=i.getNextNode();d;){if(d.isFirstNode){d.isFirstNode=!1,n.setNodeLineIcos(e,d);break}if(d.isLastNode)break;d=d.getNextNode()}},clearOldLastNode:function(e,i,d){for(var o=i.getPreNode();o;){if(o.isLastNode){o.isLastNode=!1,d&&n.setNodeLineIcos(e,o);break}if(o.isFirstNode)break;o=o.getPreNode()}},makeDOMNodeMainBefore:function(e,i,d){e.push("<li ",d.isHidden?"style='display:none;' ":"","id='",d.tId,"' class='",s.className.LEVEL,d.level,"' tabindex='0' hidefocus='true' treenode>")},showNode:function(e,i,d){i.isHidden=!1,r.initShowForExCheck(e,i),a(i,e).show()},showNodes:function(e,i,d){if(i&&0!=i.length){var o,t,s={};for(o=0,t=i.length;o<t;o++){var a=i[o];if(!s[a.parentTId]){var N=a.getParentNode();s[a.parentTId]=null===N?r.getRoot(e):a.getParentNode()}n.showNode(e,a,d)}for(var c in s){var h=s[c][e.data.key.children];n.setFirstNodeForShow(e,h),n.setLastNodeForShow(e,h)}}},hideNode:function(e,i,d){i.isHidden=!0,i.isFirstNode=!1,i.isLastNode=!1,r.initHideForExCheck(e,i),n.cancelPreSelectedNode(e,i),a(i,e).hide()},hideNodes:function(e,i,d){if(i&&0!=i.length){var o,t,s={};for(o=0,t=i.length;o<t;o++){var a=i[o];if((a.isFirstNode||a.isLastNode)&&!s[a.parentTId]){var N=a.getParentNode();s[a.parentTId]=null===N?r.getRoot(e):a.getParentNode()}n.hideNode(e,a,d)}for(var c in s){var h=s[c][e.data.key.children];n.setFirstNodeForHide(e,h),n.setLastNodeForHide(e,h)}}},setFirstNode:function(e,i){var d=e.data.key.children,o=i[d].length;o>0&&!i[d][0].isHidden?i[d][0].isFirstNode=!0:o>0&&n.setFirstNodeForHide(e,i[d])},setLastNode:function(e,i){var d=e.data.key.children,o=i[d].length;o>0&&!i[d][0].isHidden?i[d][o-1].isLastNode=!0:o>0&&n.setLastNodeForHide(e,i[d])},setFirstNodeForHide:function(e,i){var d,o,t;for(o=0,t=i.length;o<t&&!(d=i[o]).isFirstNode;o++){if(!d.isHidden&&!d.isFirstNode){d.isFirstNode=!0,n.setNodeLineIcos(e,d);break}d=null}return d},setFirstNodeForShow:function(e,i){var d,o,t,s,r;for(o=0,t=i.length;o<t;o++){if(d=i[o],!s&&!d.isHidden&&d.isFirstNode){s=d;break}if(s||d.isHidden||d.isFirstNode){if(s&&d.isFirstNode){d.isFirstNode=!1,r=d,n.setNodeLineIcos(e,d);break}d=null}else d.isFirstNode=!0,s=d,n.setNodeLineIcos(e,d)}return{new:s,old:r}},setLastNodeForHide:function(e,i){var d,o;for(o=i.length-1;o>=0&&!(d=i[o]).isLastNode;o--){if(!d.isHidden&&!d.isLastNode){d.isLastNode=!0,n.setNodeLineIcos(e,d);break}d=null}return d},setLastNodeForShow:function(e,i){var d,o,t,s;for(o=i.length-1;o>=0;o--){if(d=i[o],!t&&!d.isHidden&&d.isLastNode){t=d;break}if(t||d.isHidden||d.isLastNode){if(t&&d.isLastNode){d.isLastNode=!1,s=d,n.setNodeLineIcos(e,d);break}d=null}else d.isLastNode=!0,t=d,n.setNodeLineIcos(e,d)}return{new:t,old:s}}},data:{initHideForExCheck:function(e,i){i.isHidden&&e.check&&e.check.enable&&(void 0===i._nocheck&&(i._nocheck=!!i.nocheck,i.nocheck=!0),i.check_Child_State=-1,n.repairParentChkClassWithSelf&&n.repairParentChkClassWithSelf(e,i))},initShowForExCheck:function(e,i){if(!i.isHidden&&e.check&&e.check.enable){if(void 0!==i._nocheck&&(i.nocheck=i._nocheck,delete i._nocheck),n.setChkClass){var d=a(i,s.id.CHECK,e);n.setChkClass(e,d,i)}n.repairParentChkClassWithSelf&&n.repairParentChkClassWithSelf(e,i)}}}};i.extend(!0,i.fn.zTree._z,d);var o=i.fn.zTree,t=o._z.tools,s=o.consts,n=o._z.view,r=o._z.data,a=(o._z.event,t.$);r.addInitNode(function(e,i,d,o,s,n,a){"string"==typeof d.isHidden&&(d.isHidden=t.eqs(d.isHidden,"true")),d.isHidden=!!d.isHidden,r.initHideForExCheck(e,d)}),r.addBeforeA(function(e,i,d){}),r.addZTreeTools(function(e,i){i.showNodes=function(i,d){n.showNodes(e,i,d)},i.showNode=function(i,d){i&&n.showNodes(e,[i],d)},i.hideNodes=function(i,d){n.hideNodes(e,i,d)},i.hideNode=function(i,d){i&&n.hideNodes(e,[i],d)};var d=i.checkNode;d&&(i.checkNode=function(e,o,t,s){e&&e.isHidden||d.apply(i,arguments)})});var N=r.initNode;r.initNode=function(e,i,d,o,t,s,a){var c=(o||r.getRoot(e))[e.data.key.children];r.tmpHideFirstNode=n.setFirstNodeForHide(e,c),r.tmpHideLastNode=n.setLastNodeForHide(e,c),a&&(n.setNodeLineIcos(e,r.tmpHideFirstNode),n.setNodeLineIcos(e,r.tmpHideLastNode)),r.tmpHideFirstNode,s=r.tmpHideLastNode===d,N&&N.apply(r,arguments),a&&s&&n.clearOldLastNode(e,d,a)};var c=r.makeChkFlag;c&&(r.makeChkFlag=function(e,i){i&&i.isHidden||c.apply(r,arguments)});var h=r.getTreeCheckedNodes;h&&(r.getTreeCheckedNodes=function(e,i,d,o){if(i&&i.length>0){var t=i[0].getParentNode();if(t&&t.isHidden)return[]}return h.apply(r,arguments)});var l=r.getTreeChangeCheckedNodes;l&&(r.getTreeChangeCheckedNodes=function(e,i,d){if(i&&i.length>0){var o=i[0].getParentNode();if(o&&o.isHidden)return[]}return l.apply(r,arguments)});var f=n.expandCollapseSonNode;f&&(n.expandCollapseSonNode=function(e,i,d,o,t){i&&i.isHidden||f.apply(n,arguments)});var k=n.setSonNodeCheckBox;k&&(n.setSonNodeCheckBox=function(e,i,d,o){i&&i.isHidden||k.apply(n,arguments)});var u=n.repairParentChkClassWithSelf;u&&(n.repairParentChkClassWithSelf=function(e,i){i&&i.isHidden||u.apply(n,arguments)}),e("ztree.hide",i.fn.zTree)});