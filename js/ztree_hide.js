layui.define(["jquery","ztree"],function(e){layui.$;var i={view:{clearOldFirstNode:function(e,i){for(var d=i.getNextNode();d;){if(d.isFirstNode){d.isFirstNode=!1,s.setNodeLineIcos(e,d);break}if(d.isLastNode)break;d=d.getNextNode()}},clearOldLastNode:function(e,i,d){for(var o=i.getPreNode();o;){if(o.isLastNode){o.isLastNode=!1,d&&s.setNodeLineIcos(e,o);break}if(o.isFirstNode)break;o=o.getPreNode()}},makeDOMNodeMainBefore:function(e,i,d){e.push("<li ",d.isHidden?"style='display:none;' ":"","id='",d.tId,"' class='",t.className.LEVEL,d.level,"' tabindex='0' hidefocus='true' treenode>")},showNode:function(e,i,d){i.isHidden=!1,n.initShowForExCheck(e,i),r(i,e).show()},showNodes:function(e,i,d){if(i&&0!=i.length){var o,t,r={};for(o=0,t=i.length;o<t;o++){var a=i[o];if(!r[a.parentTId]){var N=a.getParentNode();r[a.parentTId]=null===N?n.getRoot(e):a.getParentNode()}s.showNode(e,a,d)}for(var c in r){var h=r[c][e.data.key.children];s.setFirstNodeForShow(e,h),s.setLastNodeForShow(e,h)}}},hideNode:function(e,i,d){i.isHidden=!0,i.isFirstNode=!1,i.isLastNode=!1,n.initHideForExCheck(e,i),s.cancelPreSelectedNode(e,i),r(i,e).hide()},hideNodes:function(e,i,d){if(i&&0!=i.length){var o,t,r={};for(o=0,t=i.length;o<t;o++){var a=i[o];if((a.isFirstNode||a.isLastNode)&&!r[a.parentTId]){var N=a.getParentNode();r[a.parentTId]=null===N?n.getRoot(e):a.getParentNode()}s.hideNode(e,a,d)}for(var c in r){var h=r[c][e.data.key.children];s.setFirstNodeForHide(e,h),s.setLastNodeForHide(e,h)}}},setFirstNode:function(e,i){var d=e.data.key.children,o=i[d].length;o>0&&!i[d][0].isHidden?i[d][0].isFirstNode=!0:o>0&&s.setFirstNodeForHide(e,i[d])},setLastNode:function(e,i){var d=e.data.key.children,o=i[d].length;o>0&&!i[d][0].isHidden?i[d][o-1].isLastNode=!0:o>0&&s.setLastNodeForHide(e,i[d])},setFirstNodeForHide:function(e,i){var d,o,t;for(o=0,t=i.length;o<t&&!(d=i[o]).isFirstNode;o++){if(!d.isHidden&&!d.isFirstNode){d.isFirstNode=!0,s.setNodeLineIcos(e,d);break}d=null}return d},setFirstNodeForShow:function(e,i){var d,o,t,n,r;for(o=0,t=i.length;o<t;o++){if(d=i[o],!n&&!d.isHidden&&d.isFirstNode){n=d;break}if(n||d.isHidden||d.isFirstNode){if(n&&d.isFirstNode){d.isFirstNode=!1,r=d,s.setNodeLineIcos(e,d);break}d=null}else d.isFirstNode=!0,n=d,s.setNodeLineIcos(e,d)}return{new:n,old:r}},setLastNodeForHide:function(e,i){var d,o;for(o=i.length-1;o>=0&&!(d=i[o]).isLastNode;o--){if(!d.isHidden&&!d.isLastNode){d.isLastNode=!0,s.setNodeLineIcos(e,d);break}d=null}return d},setLastNodeForShow:function(e,i){var d,o,t,n;for(o=i.length-1;o>=0;o--){if(d=i[o],!t&&!d.isHidden&&d.isLastNode){t=d;break}if(t||d.isHidden||d.isLastNode){if(t&&d.isLastNode){d.isLastNode=!1,n=d,s.setNodeLineIcos(e,d);break}d=null}else d.isLastNode=!0,t=d,s.setNodeLineIcos(e,d)}return{new:t,old:n}}},data:{initHideForExCheck:function(e,i){i.isHidden&&e.check&&e.check.enable&&(void 0===i._nocheck&&(i._nocheck=!!i.nocheck,i.nocheck=!0),i.check_Child_State=-1,s.repairParentChkClassWithSelf&&s.repairParentChkClassWithSelf(e,i))},initShowForExCheck:function(e,i){if(!i.isHidden&&e.check&&e.check.enable){if(void 0!==i._nocheck&&(i.nocheck=i._nocheck,delete i._nocheck),s.setChkClass){var d=r(i,t.id.CHECK,e);s.setChkClass(e,d,i)}s.repairParentChkClassWithSelf&&s.repairParentChkClassWithSelf(e,i)}}}};$.extend(!0,$.fn.zTree._z,i);var d=$.fn.zTree,o=d._z.tools,t=d.consts,s=d._z.view,n=d._z.data,r=(d._z.event,o.$);n.addInitNode(function(e,i,d,t,s,r,a){"string"==typeof d.isHidden&&(d.isHidden=o.eqs(d.isHidden,"true")),d.isHidden=!!d.isHidden,n.initHideForExCheck(e,d)}),n.addBeforeA(function(e,i,d){}),n.addZTreeTools(function(e,i){i.showNodes=function(i,d){s.showNodes(e,i,d)},i.showNode=function(i,d){i&&s.showNodes(e,[i],d)},i.hideNodes=function(i,d){s.hideNodes(e,i,d)},i.hideNode=function(i,d){i&&s.hideNodes(e,[i],d)};var d=i.checkNode;d&&(i.checkNode=function(e,o,t,s){e&&e.isHidden||d.apply(i,arguments)})});var a=n.initNode;n.initNode=function(e,i,d,o,t,r,N){var c=(o||n.getRoot(e))[e.data.key.children];n.tmpHideFirstNode=s.setFirstNodeForHide(e,c),n.tmpHideLastNode=s.setLastNodeForHide(e,c),N&&(s.setNodeLineIcos(e,n.tmpHideFirstNode),s.setNodeLineIcos(e,n.tmpHideLastNode)),n.tmpHideFirstNode,r=n.tmpHideLastNode===d,a&&a.apply(n,arguments),N&&r&&s.clearOldLastNode(e,d,N)};var N=n.makeChkFlag;N&&(n.makeChkFlag=function(e,i){i&&i.isHidden||N.apply(n,arguments)});var c=n.getTreeCheckedNodes;c&&(n.getTreeCheckedNodes=function(e,i,d,o){if(i&&i.length>0){var t=i[0].getParentNode();if(t&&t.isHidden)return[]}return c.apply(n,arguments)});var h=n.getTreeChangeCheckedNodes;h&&(n.getTreeChangeCheckedNodes=function(e,i,d){if(i&&i.length>0){var o=i[0].getParentNode();if(o&&o.isHidden)return[]}return h.apply(n,arguments)});var l=s.expandCollapseSonNode;l&&(s.expandCollapseSonNode=function(e,i,d,o,t){i&&i.isHidden||l.apply(s,arguments)});var f=s.setSonNodeCheckBox;f&&(s.setSonNodeCheckBox=function(e,i,d,o){i&&i.isHidden||f.apply(s,arguments)});var k=s.repairParentChkClassWithSelf;k&&(s.repairParentChkClassWithSelf=function(e,i){i&&i.isHidden||k.apply(s,arguments)}),e("ztree.hide",$.fn.zTree)});