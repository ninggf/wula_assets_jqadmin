layui.define(["jquery","ztree"],function(e){var i=layui.$,d={view:{clearOldFirstNode:function(e,i){for(var d=i.getNextNode();d;){if(d.isFirstNode){d.isFirstNode=!1,c.setNodeLineIcos(e,d);break}if(d.isLastNode)break;d=d.getNextNode()}},clearOldLastNode:function(e,i,d){for(var o=i.getPreNode();o;){if(o.isLastNode){o.isLastNode=!1,d&&c.setNodeLineIcos(e,o);break}if(o.isFirstNode)break;o=o.getPreNode()}},makeDOMNodeMainBefore:function(e,i,d){e.push("<li ",d.isHidden?"style='display:none;' ":"","id='",d.tId,"' class='",t.className.LEVEL,d.level,"' tabindex='0' hidefocus='true' treenode>")},showNode:function(e,i,d){i.isHidden=!1,h.initShowForExCheck(e,i),s(i,e).show()},showNodes:function(e,i,d){if(i&&0!=i.length){var o,t,s={};for(o=0,t=i.length;o<t;o++){var n=i[o];if(!s[n.parentTId]){var r=n.getParentNode();s[n.parentTId]=null===r?h.getRoot(e):n.getParentNode()}c.showNode(e,n,d)}for(var a in s){var N=s[a][e.data.key.children];c.setFirstNodeForShow(e,N),c.setLastNodeForShow(e,N)}}},hideNode:function(e,i,d){i.isHidden=!0,i.isFirstNode=!1,i.isLastNode=!1,h.initHideForExCheck(e,i),c.cancelPreSelectedNode(e,i),s(i,e).hide()},hideNodes:function(e,i,d){if(i&&0!=i.length){var o,t,s={};for(o=0,t=i.length;o<t;o++){var n=i[o];if((n.isFirstNode||n.isLastNode)&&!s[n.parentTId]){var r=n.getParentNode();s[n.parentTId]=null===r?h.getRoot(e):n.getParentNode()}c.hideNode(e,n,d)}for(var a in s){var N=s[a][e.data.key.children];c.setFirstNodeForHide(e,N),c.setLastNodeForHide(e,N)}}},setFirstNode:function(e,i){var d=e.data.key.children,o=i[d].length;0<o&&!i[d][0].isHidden?i[d][0].isFirstNode=!0:0<o&&c.setFirstNodeForHide(e,i[d])},setLastNode:function(e,i){var d=e.data.key.children,o=i[d].length;0<o&&!i[d][0].isHidden?i[d][o-1].isLastNode=!0:0<o&&c.setLastNodeForHide(e,i[d])},setFirstNodeForHide:function(e,i){var d,o,t;for(o=0,t=i.length;o<t&&!(d=i[o]).isFirstNode;o++){if(!d.isHidden&&!d.isFirstNode){d.isFirstNode=!0,c.setNodeLineIcos(e,d);break}d=null}return d},setFirstNodeForShow:function(e,i){var d,o,t,s,n;for(o=0,t=i.length;o<t;o++){if(d=i[o],!s&&!d.isHidden&&d.isFirstNode){s=d;break}if(s||d.isHidden||d.isFirstNode){if(s&&d.isFirstNode){d.isFirstNode=!1,n=d,c.setNodeLineIcos(e,d);break}d=null}else d.isFirstNode=!0,s=d,c.setNodeLineIcos(e,d)}return{new:s,old:n}},setLastNodeForHide:function(e,i){var d,o;for(o=i.length-1;0<=o&&!(d=i[o]).isLastNode;o--){if(!d.isHidden&&!d.isLastNode){d.isLastNode=!0,c.setNodeLineIcos(e,d);break}d=null}return d},setLastNodeForShow:function(e,i){var d,o,t,s;for(o=i.length-1;0<=o;o--){if(d=i[o],!t&&!d.isHidden&&d.isLastNode){t=d;break}if(t||d.isHidden||d.isLastNode){if(t&&d.isLastNode){d.isLastNode=!1,s=d,c.setNodeLineIcos(e,d);break}d=null}else d.isLastNode=!0,t=d,c.setNodeLineIcos(e,d)}return{new:t,old:s}}},data:{initHideForExCheck:function(e,i){i.isHidden&&e.check&&e.check.enable&&(void 0===i._nocheck&&(i._nocheck=!!i.nocheck,i.nocheck=!0),i.check_Child_State=-1,c.repairParentChkClassWithSelf&&c.repairParentChkClassWithSelf(e,i))},initShowForExCheck:function(e,i){if(!i.isHidden&&e.check&&e.check.enable){if(void 0!==i._nocheck&&(i.nocheck=i._nocheck,delete i._nocheck),c.setChkClass){var d=s(i,t.id.CHECK,e);c.setChkClass(e,d,i)}c.repairParentChkClassWithSelf&&c.repairParentChkClassWithSelf(e,i)}}}};i.extend(!0,i.fn.zTree._z,d);var o=i.fn.zTree,r=o._z.tools,t=o.consts,c=o._z.view,h=o._z.data,s=(o._z.event,r.$);h.addInitNode(function(e,i,d,o,t,s,n){"string"==typeof d.isHidden&&(d.isHidden=r.eqs(d.isHidden,"true")),d.isHidden=!!d.isHidden,h.initHideForExCheck(e,d)}),h.addBeforeA(function(e,i,d){}),h.addZTreeTools(function(d,t){t.showNodes=function(e,i){c.showNodes(d,e,i)},t.showNode=function(e,i){e&&c.showNodes(d,[e],i)},t.hideNodes=function(e,i){c.hideNodes(d,e,i)},t.hideNode=function(e,i){e&&c.hideNodes(d,[e],i)};var s=t.checkNode;s&&(t.checkNode=function(e,i,d,o){e&&e.isHidden||s.apply(t,arguments)})});var a=h.initNode;h.initNode=function(e,i,d,o,t,s,n){var r=(o||h.getRoot(e))[e.data.key.children];h.tmpHideFirstNode=c.setFirstNodeForHide(e,r),h.tmpHideLastNode=c.setLastNodeForHide(e,r),n&&(c.setNodeLineIcos(e,h.tmpHideFirstNode),c.setNodeLineIcos(e,h.tmpHideLastNode)),t=h.tmpHideFirstNode===d,s=h.tmpHideLastNode===d,a&&a.apply(h,arguments),n&&s&&c.clearOldLastNode(e,d,n)};var n=h.makeChkFlag;n&&(h.makeChkFlag=function(e,i){i&&i.isHidden||n.apply(h,arguments)});var N=h.getTreeCheckedNodes;N&&(h.getTreeCheckedNodes=function(e,i,d,o){if(i&&0<i.length){var t=i[0].getParentNode();if(t&&t.isHidden)return[]}return N.apply(h,arguments)});var l=h.getTreeChangeCheckedNodes;l&&(h.getTreeChangeCheckedNodes=function(e,i,d){if(i&&0<i.length){var o=i[0].getParentNode();if(o&&o.isHidden)return[]}return l.apply(h,arguments)});var f=c.expandCollapseSonNode;f&&(c.expandCollapseSonNode=function(e,i,d,o,t){i&&i.isHidden||f.apply(c,arguments)});var k=c.setSonNodeCheckBox;k&&(c.setSonNodeCheckBox=function(e,i,d,o){i&&i.isHidden||k.apply(c,arguments)});var u=c.repairParentChkClassWithSelf;u&&(c.repairParentChkClassWithSelf=function(e,i){i&&i.isHidden||u.apply(c,arguments)}),e("ztree.hide",i.fn.zTree)});